val codes = Array(
  "a\t100100",
  "b\t100101",
  "c\t110001",
  "d\t100000",
  "[newline]\t111111",
  "p\t111110",
  "q\t000001"
)

val anotherCodes = Array(
  "[newline]\t010100","2\t010101","4\t010110","9\t010111",":\t011000","G\t011001","K\t011010","M\t011011","V\t011100","j\t011101","q\t011110","1\t011111","6\t100000","B\t100001","C\t100010","I\t100011","W\t100100","x\t100101","\"\t100110","5\t100111","8\t101000","E\t101001","F\t101010","k\t101011","R\t101100","S\t101101","0\t101110","A\t101111","L\t110000","-\t110001",".\t110010",",\t110011","v\t110100","b\t110101","p\t110110","g\t110111","w\t111000","y\t111001","m\t111010","f\t111011","u\t111100","c\t111101","s\t111110","h\t111111","d\t00000","l\t00001","r\t00010","i\t00011","o\t00100","a\t00101","n\t00110","t\t00111","e\t01000"," \t01001"
)

val thirdCodes = Array(
  "a\t100100",
  "b\t0101",
  "[newline]\t111111"
)

val encoded = "111110000001100100111111100101110001111110"
val anotherEncoded = "10010000011001111111110100100111111111010000100111110100100000010000100101110110111110010000100100100111011010011011000010011101000101001100100100010111100000010100001001000110011001001001111111110100001001010000010100010000011110010100110011100111111111010011111010100000110001111111000001011100111001101001110000001000011000000001000011001001111101010000010111111001000000000100100111001000100111010101000010010010101001111101001011101100001100111001010000101001001010011000000010010011111111101000010011110000010100001000010100000000010011111010001100111111001010010010011101101001110000001000011000000000110011000011111100111010010011110000010111111001001010001110111110110100011110100111000111101000100000001111001010010010111010100101001100000000100001100100000000110011010010010100001001111111110010011110011011111111101001101100001001110100010100110010011111010001111010000011000010001111111000101001110001100100001100100111111111110000110110111010010010000110010010001100110010010011111111101000010011011010011101001011011001010001000111000110011011000100011001101100010011111111101000110001101010000110100000001000001111100100100101000100100000101010011111000011000111000110000101001001010001000100111100001100000001001010110100111101110110010010011010100001000100111010010010010100010001001111000011000000010011001111011101011101100110100100101001100100110111100110110111000010010011000110110100101100101001000011001001111110010000011100111000010100011101001000001100011101001101011001100010011100000110010010010111111001001110000111100001100000001000001101110000001111110101001000000100011010001000000010010011011001000000000100100011001100100100111111111010000100111111000101111010010000100100101000100100000101110011010011111100000100011110111111111001110000111100101001001110010001001001111111110100001001111000010001111100011101001001001110110100100111111111010000100100100000010000001001101100001001110100010100110010011111010001100111111001110010010011000011110010100100101110101001001111000011101001100000101000101110110011010010001100111010011111110010100000010010001001000110100000111101000100000000010011111101111001110111110110001111110100011010000011000111000011110010100100111001000100111010101000111101001001110100100001001001010100111101000101011101001000001001001110110001000001000111110011010010010100001001111111110010011110011011111111101001001111111110100000010010000100100011111110010010000100011001110011100001010000100101000110100000110000001000001101111010100001001001001110110100100001001010001011011101000110001111110111101001010000101000010011101100001000100000001111001111010011100011001000011001001001001110110100111011100100001000000011111011001001001101010000100010011101001001001111111110100001001101000010101101110111110010010011111111101000010010011100100111000001100100100000010001111010000100011001100100000000010011101010100011110100101111100111110010000100100100111011010010001001000110110010000010100111010000000001001011100000111010110001100110110111010010010100111001110010111110110101111111011001101001001010011000000010010011111111101000010011011110011011011100001001001100011011010010110010100100001100100110001011111100010001000011000011111101000010100001001000100100011110100100000100000001000000000100100111111111001010011101001000110011101001111000001011111100100110011000010010001110110010011110000110000000100000000100110010011101011110010100110111100001111011000100100000000010010011111111101000010010110010001001000001010011101001000110011001001101000101000100000110010010011011110001011110111111100101010000010000001001001101110001111110100101000010100100010010001111100100000101000101111011111110100111111011111100100111000111110010010011111111100101001110100100111111111000111111100100100011001101101000010000001110100010000000001001001011101010010100110000000010000110111010010000011000111010010010011101101001110000111100001100000001000001101110000001111110101001001010011000000010010010101001000100100011010000011110100001010000101001001001110110100100001000111110110100001001001010011000000010010011100010001010000001000010011110000001100111111111000110011001001001111111110100001001001000000100000010011011000010011101000101001100100111100000101000010000111111011001001001110000001000011000000001000011001001001111111110100000110010011101110001001000111000010011111100000100100111000000011110010100111110000110001110001100001010010010111010100100111100001110100101011110011110111011001101001001011110110011101000000100100111100011111100011111101111111010010010111110100111000111101000001100111111001010010001100110111101000100100000101111110010000000001001000000001000101111010001010011100011111101001010000100001111001110010010011000011110010100100111111111010000100101111101111100111111111010011111010100000110001111111000001011100111001101001110000001000011000000001000011001001111000001011111100100111010101000111001001000011000000010010010100001000010100111110100100111010110110001010001000011111110001000011001001001111111110100001001000010010100010110111010001111100011101001001110010011100000110010010001100110010011010010011011011100001001010011000000110010010011001000100011111000111111010000110011011111000111010000001001001101111110101110101010001110011100110100100010010001101011111000001100001001110100100011001100100100111111111010000100110110000100111010001010011001000111110011110111100010000100111111000111111001000010100001001110101111001010010110100001100110110111010011010010000011100000101000100000001001001111111110100001001100010001000011011101101000111110111110001000001011001101001111000001011111100100100100001100100001001001001110110100100111111111010000100111011100010001010011000000010001111100011101001111101111111111100000101111011111110100011111001001000110011001001101001111100000100010011011001000110010010011001000001100110111101111111010001111100011101000000100100111111100101000000100111011000010010001101000001100100111100111110000011110010100111010101000010000011001001001111111110100001001111101001011101100001100111001010000101001001001110110100110111100110110111000010010011000110110100101100101001000011001001101001001101101110000100101001100000011001101001110101111100001110100111101100010001001110100100100111111111000111111100100100111000111110100100001001001000011011001101001110000001000011000000001000011001001110101010001111010010111101001000010010011111111101000010011110100010100011001100100111101100100000101111001110100100111101100100000100100111101100100000100100000011110111001100100100111000100010100000010000001011111001001001010011000000010010011111111101000010011101010010111111001000010011110110010000010010010000001000111011010000011011110101000010010001100110010010011100011111010010000100100100111011010011110000010100010110010010011000110011001001001111111110100001001110100000110100011100001001001001110110100110101000010001010011010101101001101101001110100000110001110010000110011000010011001101000110011101001111111001010000001001001111111110100001001000100100011111000100111100000101111010100011111011001101001001010011000000010010001100111010011110000010111111001001000100010111011000011000000000111100101001000000100011010001000000010010011011000011001101101110100100111111111010000100100000000111101110011000011001111110010100100101001100000001001001111111110100001001110110001000000100011001110001111110100101000010100111111001000000011110111100011111010010000110111110111101000110010011110011111000110010001111101111100100100101110110110110000100010011011000010000110010100111010000100100111001000100100101010010011000101001110001100100001100010100001010011111010010111011000011001110010100001110010100110010100"
val thirdEncoded = "1001001111110101"

def getCodesWithSize(codes: Array[String]): Map[String, (String, Int)] = {
  codes.flatMap(code => code.split("\\t")).grouped(2).map { case Array(k, v) => (k, (v, v.length)) }.toMap
}

def decode(codes: Array[String], encoded: String): String = {
  val c = getCodesWithSize(codes)
  val distinctSizes = c.values.map(x => x._2).toList.distinct
  val result = new StringBuffer

  var newEncoded = encoded

  while(newEncoded.length > 0) {
    c.foreach { case(k, v) =>
      distinctSizes.foreach(s => {
        if(newEncoded.length >= s) {
          val piece = newEncoded.substring(0, s)
          val stringToReplace = if(k.equals("[newline]")) "\n" else k
          if(v._1.equals(piece)) {
            result.append(stringToReplace)
            newEncoded = newEncoded.drop(s)
          }
        }
      })
    }
  }
  result.toString
}

decode(anotherCodes, anotherEncoded)